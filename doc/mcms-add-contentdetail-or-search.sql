UPDATE `mdiy_tag` SET `tag_name` = 'arclist', `tag_type` = 'list', `tag_sql` = '<#assign _typeid=\'\'/>\r\n<#assign _typetitle=\'\'/>\r\n<#assign _size=\'20\'/>\r\n\r\n<#if column?? && column.id?? && column.id?number gt 0>\r\n  <#assign  _typeid=\'${column.id}\'>\r\n</#if>\r\n\r\n<#if typeid??>\r\n  <#assign  _typeid=\'${typeid}\'>\r\n</#if>\r\n\r\n<#if typetitle??>\r\n  <#assign  _typetitle=\'${typetitle}\'>\r\n</#if>\r\n\r\n<#if size??>\r\n  <#assign  _size=\'${size}\'>\r\n</#if>\r\n\r\n<#if orderby?? >\r\n    <#if orderby==\'date\'>\r\n      <#assign  _orderby=\'content_datetime\'>\r\n  <#elseif orderby==\'updatedate\'>\r\n    <#assign  _orderby=\'content_updatetime\'>\r\n    <#elseif orderby==\'hit\'>\r\n      <#assign  _orderby=\'content_hit\'>\r\n    <#elseif orderby==\'sort\'>\r\n      <#assign  _orderby=\'content_sort\'>\r\n    <#else>\r\n        <#assign  _orderby=\'cms_content.id\'>\r\n     </#if>\r\n<#else>\r\n    <#assign  _orderby=\'cms_content.id\'>\r\n</#if>\r\n\r\nSELECT\r\n  cms_content.id AS id,\r\n  content_title AS title,\r\n  content_title AS fulltitle,\r\n  content_author AS author,\r\n  content_source AS source,\r\n  content_details AS content,\r\n  category.category_title AS typetitle,\r\n  category.id AS typeid,\r\ncategory.category_path AS typepath,\r\n  category.category_img AS typelitpic,\r\n  category.category_keyword as typekeyword,\r\n  category.top_id as topId,\r\n  category.category_parent_ids as parentids,\r\n  category.category_type AS \"type\",\r\n\r\n  <#--列表页动态链接-->\r\n  <#if isDo?? && isDo>\r\n    CONCAT(\'/${modelName}/list.do?typeid=\', category.category_id) as typelink,\r\n  <#else>\r\n    (SELECT \'index.html\') AS typelink,\r\n  </#if>\r\n    content_description AS descrip,\r\n    content_hit AS hit,\r\n    content_type AS flag,\r\n    cms_content.content_keyword AS keyword,\r\n    content_img AS litpic,\r\n  \r\n  <#--内容页动态链接-->\r\n  <#if isDo?? && isDo>\r\n    CONCAT(\'/${modelName}/view.do?id=\', cms_content.id,\'&orderby=${_orderby}\',\'&order=${order!\'ASC\'}\',\'&typeid=${typeid}\') as \"link\",\r\n  <#else>\r\n    CONCAT(category.category_path,\'/\',if(category_type=2,\"index\",cms_content.id),\'.html\') AS \"link\",\r\n  </#if>\r\n\r\n  <#if tableName??>${tableName}.*,</#if>\r\n  content_datetime AS \"date\"\r\nFROM\r\n  cms_content LEFT JOIN cms_category as category\r\n  ON cms_content.category_id = category.id\r\n\r\n  <#--判断是否有自定义模型表-->\r\n  <#if tableName??>\r\n    LEFT JOIN ${tableName} ON ${tableName}.link_id=cms_content.id\r\n  </#if>\r\n  WHERE  \r\n    content_display=0\r\n    and cms_content.del=0\r\n    <#--根据站点编号查询-->\r\n    <#if appId?? >\r\n      and cms_content.app_id=${appId}\r\n      and cms_content.id>0\r\n    </#if>\r\n    <#--判断是否有搜索分类集合-->\r\n    <#if search?? && _typeid==\"\">\r\n      <#if search.categoryIds?has_content>and FIND_IN_SET(category.id,\'${search.categoryIds}\')</#if>\r\n        <#--标题-->\r\n        <#if search.content_title??> and content_title like CONCAT(\'%\',\'${search.content_title}\',\'%\')</#if>\r\n        <#--作者-->\r\n        <#if search.content_author??> and content_author like CONCAT(\'%\',\'${search.content_author}\',\'%\')</#if>\r\n        <#--来源-->\r\n        <#if search.content_source??> and content_source like CONCAT(\'%\',\'${search.content_source}\',\'%\')</#if>\r\n        <#--属性-->\r\n        <#if search.content_type??> and  (\r\n          <#list search.content_type?split(\',\') as item>\r\n            <#if item?index gt 0> or</#if>\r\n            FIND_IN_SET(\'${item}\',cms_content.content_type)\r\n          </#list>)\r\n        </#if>\r\n\r\n        <#--描述-->\r\n        <#if search.content_description??>\r\n        and content_description like CONCAT(\'%\',\'${search.content_description}\',\'%\')\r\n        </#if>\r\n\r\n        <#--关键字-->\r\n        <#if search.content_keyword??> and content_keyword like CONCAT(\'%\',\'${search.content_keyword}\',\'%\')</#if>\r\n\r\n        <#--内容-->\r\n        <#if search.content_details??> and content_details like CONCAT(\'%\',\'${search.content_details}\',\'%\')</#if>\r\n        <#if search.content_details_or??> or content_details like CONCAT(\'%\',\'${search.content_details_or}\',\'%\')</#if>\r\n\r\n    <#--自定义顺序-->\r\n        <#if search.content_sort??> and content_sort=${search.content_sort}</#if>\r\n    <#--时间范围-->\r\n        <#if search.content_datetime_start??&&search.content_datetime_end??>\r\n          and content_datetime between \'${search.content_datetime_start}\' and \'${search.content_datetime_end}\'\r\n        </#if>\r\n    <#else>\r\n      <#--查询栏目-->\r\n      <#if _typeid?has_content> \r\n        and (cms_content.category_id=${_typeid} or cms_content.category_id in (select id FROM cms_category where cms_category.del=0 \r\n        <#if _typetitle?has_content>\r\n        and cms_category.category_title=\'${_typetitle}\'</#if> and FIND_IN_SET(${_typeid},CATEGORY_PARENT_IDS))) \r\n        </#if>\r\n    </#if>\r\n      <#--标题-->\r\n      <#if content_title??> and content_title like CONCAT(\'%\',\'${content_title}\',\'%\')</#if>\r\n      <#--作者-->\r\n      <#if content_author??> and content_author like CONCAT(\'%\',\'${content_author}\',\'%\')</#if>\r\n      <#--来源-->\r\n      <#if content_source??> and content_source like CONCAT(\'%\',\'${content_source}\',\'%\')</#if>\r\n      <#--属性-->\r\n      <#if content_type??> and content_type like CONCAT(\'%\',\'${content_type}\',\'%\')</#if>\r\n      <#--描述-->\r\n      <#if content_description??> and content_description like CONCAT(\'%\',\'${content_description}\',\'%\')</#if>\r\n      <#--关键字-->\r\n      <#if content_keyword??> and content_keyword like CONCAT(\'%\',\'${content_keyword}\',\'%\')</#if>\r\n      <#--内容-->\r\n      <#if content_details??> and content_details like CONCAT(\'%\',\'${content_details}\',\'%\')</#if>\r\n      <#if content_details_or??> or content_details like CONCAT(\'%\',\'${content_details_or}\',\'%\')</#if>\r\n      <#--自定义顺序-->\r\n      <#if content_sort??> and content_sort=${content_sort}</#if>\r\n      <#--自定义模型-->\r\n      <#if diyModel??>\r\n        <#list diyModel as dm>\r\n          and ${tableName}.${dm.key} like CONCAT(\'%\',\'${dm.value}\',\'%\') \r\n        </#list>\r\n      </#if>\r\n      <#--文章属性-->\r\n      <#if flag?? >\r\n        and(\r\n          <#list flag?split(\',\') as item>\r\n          <#if item?index gt 0> or</#if>\r\n          FIND_IN_SET(\'${item}\',cms_content.content_type)\r\n          </#list>)\r\n      </#if>\r\n      <#if noflag??>\r\n          and(\r\n          <#list noflag?split(\',\') as item>\r\n          <#if item?index gt 0> and</#if>\r\n          FIND_IN_SET(\'${item}\',cms_content.content_type)=0\r\n          </#list> or cms_content.content_type is null)\r\n      </#if>\r\n\r\n      <#--字段排序-->\r\n      <#if orderby?? >\r\n      ORDER BY\r\n          <#if orderby==\'date\'> content_datetime\r\n          <#elseif orderby==\'updatedate\'> content_updatetime\r\n          <#elseif orderby==\'hit\'> content_hit\r\n          <#elseif orderby==\'sort\'> content_sort\r\n        <#else>\r\n          cms_content.id\r\n        </#if>\r\n  <#else>\r\n      ORDER BY   cms_content.id\r\n  </#if>\r\n\r\n  <#if order?? >\r\n    <#if order==\'desc\'> desc</#if>\r\n    <#if order==\'asc\'> asc</#if>\r\n  <#else>\r\n    desc\r\n  </#if>\r\n    LIMIT \r\n  <#--判断是否分页-->\r\n  <#if ispaging?? && (pageTag.pageNo)??>\r\n      ${((pageTag.pageNo-1)*_size?eval)?c},${_size?default(20)}\r\n    <#else>\r\n      ${_size?default(20)}\r\n    </#if>', `tag_class` = NULL, `tag_description` = '文章列表', `UPDATE_BY` = NULL, `UPDATE_DATE` = NULL, `CREATE_BY` = NULL, `CREATE_DATE` = NULL, `DEL` = 0, `NOT_DEL` = 1 WHERE `id` = 3;
